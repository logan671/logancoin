# Twitter Feed Widget 기획서 (Mm.pro)

> **상태**: 초안 v0.1 | 같이 논의 중
> **목표**: Mm.pro 사이트에 엄선된 트위터 피드를 위젯으로 제공

---

## 1. 한 줄 요약

내가 마킹한 트위터 계정들의 트윗만 모아서, Mm.pro 사이트 옆에 **트위터 UI 스타일 위젯**으로 보여주는 기능.

---

## 2. 왜 만드는가 (Why)

- Polymarket 베팅에 영향을 주는 정보는 트위터에서 가장 빠르게 돌아옴
- 트위터 전체 피드는 노이즈가 너무 많음
- **내가 고른 핵심 계정들의 트윗만** 깔끔하게 보고 싶음
- Mm.pro 유저들도 양질의 정보원을 한눈에 볼 수 있게

---

## 3. 어떤 형태인가 (What)

### 위치
- Mm.pro 메인 페이지 **오른쪽 사이드바 위젯** (또는 플로팅 패널)
- 접었다/펼쳤다 가능 (토글)

### UI 컨셉
- **트위터 타임라인 UI를 최대한 재현**
  - 프로필 이미지 + 이름 + @handle + 시간
  - 트윗 본문 (텍스트, 이미지, 링크 미리보기)
  - 좋아요/RT/댓글 수 표시 (읽기 전용)
  - 스크롤 가능한 피드
- "엄선된 피드를 보고 있다"는 느낌

### 핵심 기능
| 기능 | 설명 | 우선순위 |
|------|------|----------|
| 피드 표시 | 마킹한 계정들의 트윗을 시간순으로 표시 | P0 |
| 계정 관리 | 트위터 아이디 추가/삭제 | P0 |
| 실시간 업데이트 | 새 트윗 자동 반영 | P1 |
| 트윗 클릭 | 원본 트위터 링크로 이동 | P0 |
| 위젯 토글 | 사이드바 접기/펼치기 | P1 |
| 필터/검색 | 계정별 필터, 키워드 검색 | P2 |
| 카테고리 | 계정을 그룹으로 분류 (크립토/뉴스/시사 등) | P2 |

---

## 4. 데이터는 어떻게 가져오는가 (How - Data)

### Apify 활용 방안

```
[마킹한 트위터 아이디 목록]
        ↓
[Apify Twitter Scraper] ← 주기적 실행 (Actor)
        ↓
[수집된 트윗 데이터 (JSON)]
        ↓
[우리 서버/DB에 저장]
        ↓
[Mm.pro 위젯에 표시]
```

### Apify 구체적 방식
- **Actor**: `apidojo/tweet-scraper` 또는 `quacker/twitter-scraper` 등
- **입력**: 트위터 handle 목록
- **출력**: 트윗 텍스트, 미디어, 좋아요/RT 수, 시간 등
- **실행 주기**: ?분마다 (Apify Schedule 기능 활용)

### 데이터 흐름 옵션

| 방식 | 장점 | 단점 |
|------|------|------|
| **A. Apify → 우리 DB → 위젯** | 빠른 응답, 캐싱 가능, 안정적 | DB 관리 필요 |
| **B. Apify → 직접 호출** | 심플, DB 불필요 | 느림, Apify 요금 증가 |
| **C. Apify → Webhook → 서버** | 실시간에 가까움 | 구현 복잡도 높음 |

> **추천**: A 방식 (Apify → Supabase DB → 위젯)

---

## 5. 기술 설계 (How - Tech)

### 아키텍처

```
┌─────────────┐     Schedule      ┌─────────────┐
│   Apify     │ ←─────────────── │  Apify Cron  │
│  Scraper    │                   │  (5~15분)    │
└──────┬──────┘                   └──────────────┘
       │ 트윗 데이터 (JSON)
       ▼
┌─────────────┐
│  Supabase   │ ← 트윗 저장 (tweets 테이블)
│  (DB)       │ ← 계정 저장 (accounts 테이블)
└──────┬──────┘
       │ API / Realtime
       ▼
┌─────────────────────────────┐
│  Mm.pro (Next.js)           │
│  ┌────────┐  ┌────────────┐ │
│  │ 메인   │  │ 트위터     │ │
│  │ 콘텐츠 │  │ 피드 위젯  │ │
│  │        │  │ (사이드바) │ │
│  └────────┘  └────────────┘ │
└─────────────────────────────┘
```

### DB 스키마 (초안)

```sql
-- 마킹한 트위터 계정
CREATE TABLE twitter_accounts (
  id UUID PRIMARY KEY,
  handle TEXT UNIQUE NOT NULL,      -- @elonmusk
  display_name TEXT,                -- Elon Musk
  profile_image_url TEXT,
  category TEXT,                    -- crypto, news, politics...
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 수집된 트윗
CREATE TABLE tweets (
  id UUID PRIMARY KEY,
  tweet_id TEXT UNIQUE NOT NULL,    -- 트위터 원본 ID
  account_id UUID REFERENCES twitter_accounts(id),
  content TEXT,                     -- 트윗 본문
  media_urls JSONB,                -- 이미지/동영상 URL
  like_count INTEGER DEFAULT 0,
  retweet_count INTEGER DEFAULT 0,
  reply_count INTEGER DEFAULT 0,
  tweet_url TEXT,                   -- 원본 트위터 링크
  tweeted_at TIMESTAMPTZ,          -- 트윗 작성 시간
  collected_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 프론트엔드 컴포넌트 구조

```
components/
  twitter-widget/
    TwitterWidget.tsx          -- 위젯 컨테이너 (사이드바)
    TweetCard.tsx              -- 개별 트윗 카드 (트위터 UI)
    TweetFeed.tsx              -- 트윗 리스트 (무한 스크롤)
    AccountManager.tsx         -- 계정 추가/삭제 관리
    WidgetToggle.tsx           -- 접기/펼치기 버튼
```

---

## 6. 논의 필요 사항 ❓

> 아래 항목들은 같이 정해야 할 것들:

### Q1. 업데이트 주기
- Apify 스크래핑 주기를 몇 분으로 할 건지?
- 너무 자주 → 비용 증가 / 너무 드물게 → 정보 늦음
- **제안**: 5분~15분 간격? (Apify 요금 확인 필요)

### Q2. 계정 관리 권한
- 아무나 계정을 추가할 수 있게? → 어뷰징 가능
- 관리자(너)만 추가/삭제? → 심플하지만 유연성 떨어짐
- **제안**: 초기에는 관리자만 관리, 나중에 유저 추천 기능 추가

### Q3. 트윗 보관 기간
- 수집한 트윗을 얼마나 보관할 건지?
- 무한 보관 → DB 사이즈 증가
- **제안**: 최근 7일 ~ 30일만 유지

### Q4. 위젯 위치와 크기
- 오른쪽 고정 사이드바 vs 플로팅 패널 vs 바텀시트(모바일)?
- 기본 너비? (300px? 400px?)

### Q5. 초기 마킹 계정
- 처음에 넣을 계정 목록이 있는지?
- 몇 개 정도를 관리할 건지? (10개? 50개? 100개+?)

---

## 7. Apify 비용 추정

> Apify 플랜에 따라 다르지만 대략적인 추정:

| 항목 | 추정 |
|------|------|
| 계정 수 | ~50개 |
| 스크래핑 주기 | 15분 |
| 일일 실행 횟수 | ~96회 |
| 월간 실행 횟수 | ~2,880회 |
| 예상 비용 | Apify 플랜에 따라 다름 (확인 필요) |

---

## 8. 개발 단계

### Step 1 - 데이터 파이프라인
- [ ] Apify Actor 선정 및 테스트
- [ ] Supabase 테이블 생성
- [ ] Apify → Supabase 데이터 연동
- [ ] 스케줄 설정

### Step 2 - 위젯 UI
- [ ] TweetCard 컴포넌트 (트위터 UI 재현)
- [ ] TweetFeed 리스트
- [ ] 사이드바 위젯 컨테이너
- [ ] 토글 기능

### Step 3 - 계정 관리
- [ ] 관리자 페이지에서 계정 추가/삭제
- [ ] 카테고리 분류

### Step 4 - 폴리싱
- [ ] 실시간 업데이트 (Supabase Realtime)
- [ ] 필터/검색
- [ ] 반응형 (모바일 대응)

---

## 부록: 트위터 UI 참고

트윗 카드 구성 요소:
```
┌─────────────────────────────────┐
│ [프사]  이름  @handle  · 3시간  │
│                                 │
│ 트윗 본문 텍스트가 여기에       │
│ 표시됩니다...                   │
│                                 │
│ ┌─────────────────────────┐     │
│ │     [이미지/미디어]      │     │
│ └─────────────────────────┘     │
│                                 │
│ 💬 12   🔄 45   ❤️ 234         │
└─────────────────────────────────┘
```
