# STX/stSTX 근사 백테스트 (풀 사이즈 반영)

작성일: 2026-02-19

## 목적

Bitflow STX/stSTX 풀 유동성(슬리피지 근사)까지 반영했을 때, 최근 30일 구간에서 어느 정도 수익 기회가 있었는지 추정한다.

## 입력 데이터

- STX 30일 일봉 가격: CoinGecko (`blockstack`)
- stSTX 30일 일봉 가격: CoinGecko (`stacking-dao`)
- Bitflow STX/stSTX 주력 풀 유동성:  
  `SM1793C4R5PZ4NS4VQ4WMP7SKKYVH8JZEWSZ9HCCR.stableswap-pool-stx-ststx-v-1-4`

실측값:
- `pool_liquidity_usd = 828,507.61`
- `intrinsic_stx_per_ststx = 1.15822619` (온체인 스냅샷)
- 백테스트 기간: 최근 `30`일

## 가정 (근사 모델)

- 진입 조건: `abs(edge_pct) >= 0.5%`
- `edge_pct = abs((market/intrinsic - 1) * 100)`
- 수수료(합산): `0.30%` (보수적 placeholder)
- 슬리피지 근사:
  - `impact_pct ~= 2 * order_usd / liquidity_usd * 100`
- 순엣지:
  - `net_edge_pct = edge_pct - fee_pct - impact_pct`
- `net_edge_pct > 0`일 때만 수익 발생으로 처리

## 결과 (30일)

- 공통 신호일수: `16`회 (`|edge| >= 0.5%`)

주문 크기별 추정 PnL:

1. 주문 `$500`
- 슬리피지 근사: `0.121%`
- 수익 발생: `16/16`
- 총합: `+234.3961 STX`

2. 주문 `$1,000`
- 슬리피지 근사: `0.241%`
- 수익 발생: `16/16`
- 총합: `+398.0710 STX`

3. 주문 `$2,000`
- 슬리피지 근사: `0.483%`
- 수익 발생: `12/16`
- 총합: `+541.0699 STX`

4. 주문 `$5,000`
- 슬리피지 근사: `1.207%`
- 수익 발생: `4/16`
- 총합: `+213.7313 STX`

5. 주문 `$10,000`
- 슬리피지 근사: `2.414%`
- 수익 발생: `0/16`
- 총합: `0 STX`

참고: 30일 평균 STX 가격(코인게코) `~$0.278751` 기준으로 보면,  
`398.0710 STX`는 대략 `$111` 수준이다.

## 해석

- 이 모델 기준으로는 **소형 주문(대략 $500~$2,000)** 구간에서 기회가 상대적으로 많았다.
- 주문을 키우면 슬리피지로 순엣지가 급격히 사라진다.
- 특히 `$10k`는 이 설정에서 사실상 진입 불가로 나타남.

## 중요한 한계

- 내재가치를 30일 내 고정값(스냅샷)으로 근사했다.
- quote/체결 로그 기반 실측 슬리피지가 아니라 유동성 기반 근사식을 사용했다.
- 실행 지연, 실패 트랜잭션, 라우팅 편차는 미반영.

즉, 이 결과는 **“가능성 스크리닝”** 용도이며, 실전 투입 전에는
실제 quote API/체결 데이터 기반 재백테스트가 필요하다.
